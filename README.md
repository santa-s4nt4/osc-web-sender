# Web OSC Sender (WSS Secure Version)

ブラウザからローカルネットワーク上の任意のIPアドレスに、安全なWebSocket接続 (WSS) を経由してOSCメッセージを送信するためのWebアプリケーションです。

GitHub PagesのようなHTTPSで配信されるサイトからでも、混合コンテンツブロック（Mixed Content Block）を回避してローカルのPCに接続できます。

![アプリケーションのスクリーンショット](https://storage.googleapis.com/gemini-prod/images/2024/07/03/f30554c1-4044-42f0-9774-32906b38c230.png)

## ✨ 主な機能

- **セキュアな接続**: WSS (Secure WebSocket) に対応し、HTTPSページからの接続を可能にします。
- **動的な接続先**: 中継サーバーのIPアドレスと、OSCの送信先IPアドレスをブラウザ上で自由に設定可能。
- **柔軟なメッセージ**: 任意のOSCアドレスに対し、数値またはテキスト（文字列）を送信できます。
- **自己署名証明書**: サーバー起動時にSSL証明書を自動生成するため、複雑な事前準備は不要です。

## ⚙️ 仕組み

HTTPSページから安全でないWebSocket (WS) への接続はブラウザにブロックされます。この問題を解決するため、中継サーバー自体がSSL証明書を持ち、安全なHTTPSサーバーとして動作します。

**通信の流れ:**
`ブラウザ (HTTPS)` → `WSS (暗号化)` → `Node.js 中継サーバー (HTTPS)` → `UDP (OSC)` → `OSC受信アプリケーション`

## 必要なもの

- [Node.js](https://nodejs.org/) (v14以上を推奨): 中継サーバー(`server.js`)を実行するために必要です。

## 🚀 使い方

### ステップ1：セットアップ

まず、中継サーバーを動かすPCで以下の準備をします。

```bash
# 1. このプロジェクトのファイルをダウンロードまたはクローンします。
# git clone https://...

# 2. プロジェクトフォルダに移動します。
# cd path/to/project

# 3. 必要なライブラリをインストールします。
npm install ws node-osc selfsigned
```

### ステップ2：中継サーバーの起動
OSCを中継したいPCのターミナルで、以下のコマンドを実行します。
```
node server.js
```

✅ Server is listening on: https://<Your_PC_IP>:8080` と表示されれば、サーバーは正常に起動しています。

### ステップ3：【重要】SSL証明書の信頼（初回のみ）

サーバーは「自己署名証明書」を使用しているため、初回にブラウザへ「この証明書は安全である」と手動で教える必要があります。

1.  **PCまたはスマートフォンのブラウザ**で、アドレスバーに直接以下のように入力してアクセスします。
    `(例: https://192.168.1.3:8080)`

    ```
    https://[server.jsを動かしているPCのIPアドレス]:8080
    ```

2.  「この接続ではプライバシーが保護されません」といった**警告画面が表示されます**が、これは正常な反応です。

3.  警告画面の「詳細設定」などをクリックし、**「[IPアドレス]にアクセスする（安全ではありません）」**といった趣旨のリンクを選択して先に進みます。

4.  `WebSocket Secure Server is running.` のような文字が表示されれば、証明書の信頼は完了です。

### ステップ4：ブラウザからの操作

1.  **Webページを開く**: `index.html`（GitHub PagesなどにデプロイしたURL）をブラウザで開きます。
2.  **サーバーに接続**:
    - `Server IP Address` の欄に、ステップ2で `server.js` を実行しているPCのIPアドレスを入力します。
    - `Connect` ボタンを押します。
    - ステータスが `✅ Securely connected` になれば成功です。
3.  **OSCを送信**:
    - `Destination IP`, `Port`, `OSC Address`, `Value` を設定します。
    - `Send OSC` ボタンを押すと、メッセージが送信されます。

## 📂 ファイル構成

-   **`index.html`**: ブラウザに表示されるUIです。
-   **`main.js`**: ブラウザ側の処理を担当します。`wss://`プロトコルでサーバーに接続します。
-   **`server.js`**: Node.jsで動作する**WSS対応**の中継サーバーです。`https`モジュールと`selfsigned`ライブラリを使用し、自身を安全なサーバーとして起動します。

## 📄 ライセンス

このプロジェクトは [MIT License](https://opensource.org/licenses/MIT) の下で公開されています。
